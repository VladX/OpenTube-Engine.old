include (CheckFunctionExists.cmake)
include (CheckIncludeFile.cmake)

macro (required_lib variable fileinclude libname)
 check_include_file (${fileinclude} ${variable})
 if (NOT ${variable})
  message (FATAL_ERROR "Required library ${libname} not found.")
 endif (NOT ${variable})
endmacro (required_lib)

check_function_exists (accept4 CheckFunctionExists.c HAVE_ACCEPT4)
check_function_exists (epoll_create CheckFunctionExists.c HAVE_EPOLL)
check_function_exists (kqueue CheckFunctionExists.c HAVE_KQUEUE)
check_function_exists (select select.c HAVE_SELECT)
if (NOT HAVE_EPOLL AND NOT HAVE_SELECT)
 message (FATAL_ERROR "Events is not supported by your system.")
endif (NOT HAVE_EPOLL AND NOT HAVE_SELECT)
check_function_exists (getrlimit CheckFunctionExists.c HAVE_GETRLIMIT)
check_function_exists (fork CheckFunctionExists.c HAVE_FORK_SYSCALL)
set (CMAKE_REQUIRED_LIBRARIES advapi32)
check_function_exists (CreateProcessWithLogonW CreateProcessWithLogonW.c HAVE_CREATE_PROCESS_WITH_LOGONW)
required_lib (HAVE_ZLIB_H zlib.h zlib)
required_lib (HAVE_PCRE_H pcre.h PCRE)
required_lib (HAVE_LIBINTL_H libintl.h gettext)
